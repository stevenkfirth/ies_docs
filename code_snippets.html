

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Code Snippets &mdash; IES-VE Python API  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=e6a37869" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Example Scripts" href="examples.html" />
    <link rel="prev" title="Quick Start" href="quick_start.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            IES-VE Python API
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Code Snippets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-to-access-the-current-project">How to access the current project</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-access-the-real-model">How to access the real model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-access-the-bodies-in-the-real-model">How to access the bodies in the real model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-access-the-room-bodies-in-the-real-model">How to access the room bodies in the real model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-access-the-path-of-the-current-project">How to access the path of the current project</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-ask-the-user-to-choose-a-ies-ve-result-file">How to ask the user to choose a IES-VE result file</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">IES-VE Python API</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Code Snippets</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/code_snippets.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="code-snippets">
<span id="id1"></span><h1>Code Snippets<a class="headerlink" href="#code-snippets" title="Link to this heading"></a></h1>
<section id="how-to-access-the-current-project">
<span id="id2"></span><h2>How to access the current project<a class="headerlink" href="#how-to-access-the-current-project" title="Link to this heading"></a></h2>
<p>The “current project” represents all the information and features relating to the current modelling project in the IES-VE software. This is accessed using the <a class="reference internal" href="api.html#iesve.VEProject.get_current_project" title="iesve.VEProject.get_current_project"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_current_project()</span></code></a> method of the <a class="reference internal" href="api.html#iesve.VEProject" title="iesve.VEProject"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEProject</span></code></a> class.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iesve</span>
<span class="n">currentproject</span> <span class="o">=</span> <span class="n">iesve</span><span class="o">.</span><span class="n">VEProject</span><span class="o">.</span><span class="n">get_current_project</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p><cite>currentproject</cite> is an instance of the <a class="reference internal" href="api.html#iesve.VEProject" title="iesve.VEProject"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEProject</span></code></a> class.</p></li>
</ul>
</section>
<section id="how-to-access-the-real-model">
<span id="id3"></span><h2>How to access the real model<a class="headerlink" href="#how-to-access-the-real-model" title="Link to this heading"></a></h2>
<p>The “real model” enables access to more detailed information such as the room data and heating system of the building in the IES project. The real model is always the first item of the <a class="reference internal" href="api.html#iesve.VEProject.models" title="iesve.VEProject.models"><code class="xref py py-attr docutils literal notranslate"><span class="pre">models</span></code></a> property of the <a class="reference internal" href="api.html#iesve.VEProject" title="iesve.VEProject"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEProject</span></code></a> class.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iesve</span>
<span class="n">currentproject</span> <span class="o">=</span> <span class="n">iesve</span><span class="o">.</span><span class="n">VEProject</span><span class="o">.</span><span class="n">get_current_project</span><span class="p">()</span>
<span class="n">realmodel</span> <span class="o">=</span> <span class="n">currentproject</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p><cite>currentproject</cite> is an instance of the <a class="reference internal" href="api.html#iesve.VEProject" title="iesve.VEProject"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEProject</span></code></a> class.</p></li>
<li><p><cite>realmodel</cite> is an instance of the <a class="reference internal" href="api.html#iesve.VEModel" title="iesve.VEModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEModel</span></code></a> class.</p></li>
</ul>
</section>
<section id="how-to-access-the-bodies-in-the-real-model">
<span id="id4"></span><h2>How to access the bodies in the real model<a class="headerlink" href="#how-to-access-the-bodies-in-the-real-model" title="Link to this heading"></a></h2>
<p>The “bodies” of a model are rooms or other features such as an adjacent_building, a topographical shade, a local_shade or a tree. These are accessed using the <a class="reference internal" href="api.html#iesve.VEModel.get_bodies" title="iesve.VEModel.get_bodies"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_bodies()</span></code></a> method of the <a class="reference internal" href="api.html#iesve.VEModel" title="iesve.VEModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEModel</span></code></a> class.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iesve</span>
<span class="n">currentproject</span> <span class="o">=</span> <span class="n">iesve</span><span class="o">.</span><span class="n">VEProject</span><span class="o">.</span><span class="n">get_current_project</span><span class="p">()</span>
<span class="n">realmodel</span> <span class="o">=</span> <span class="n">currentproject</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bodies</span> <span class="o">=</span> <span class="n">realmodel</span><span class="o">.</span><span class="n">get_bodies</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>   <span class="c1"># SelectedOnly = False; used to select all bodies in the model.</span>
</pre></div>
</div>
<ul class="simple">
<li><p><cite>currentproject</cite> is an instance of the <a class="reference internal" href="api.html#iesve.VEProject" title="iesve.VEProject"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEProject</span></code></a> class.</p></li>
<li><p><cite>realmodel</cite> is an instance of the <a class="reference internal" href="api.html#iesve.VEModel" title="iesve.VEModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEModel</span></code></a> class.</p></li>
<li><p><cite>bodies</cite> is a list of <a class="reference internal" href="api.html#iesve.VEBody" title="iesve.VEBody"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEBody</span></code></a> instances.</p></li>
</ul>
</section>
<section id="how-to-access-the-room-bodies-in-the-real-model">
<span id="id5"></span><h2>How to access the room bodies in the real model<a class="headerlink" href="#how-to-access-the-room-bodies-in-the-real-model" title="Link to this heading"></a></h2>
<p>This uses the <a class="reference internal" href="api.html#iesve.VEModel.get_bodies" title="iesve.VEModel.get_bodies"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_bodies()</span></code></a> method of the <a class="reference internal" href="api.html#iesve.VEModel" title="iesve.VEModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEModel</span></code></a> class to access the “bodies” in the real model. The returned list of bodies is then filtered using a Python list comprehension statement to return only those bodies which are rooms (i.e. those bodies where the <a class="reference internal" href="api.html#iesve.VEBody.type" title="iesve.VEBody.type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type</span></code></a> property is equal to the <a class="reference internal" href="api.html#iesve.VEBody_type.room" title="iesve.VEBody_type.room"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iesve.VEBody_type.room</span></code></a> instance).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iesve</span>
<span class="n">currentproject</span> <span class="o">=</span> <span class="n">iesve</span><span class="o">.</span><span class="n">VEProject</span><span class="o">.</span><span class="n">get_current_project</span><span class="p">()</span>
<span class="n">realmodel</span> <span class="o">=</span> <span class="n">currentproject</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bodies</span> <span class="o">=</span> <span class="n">realmodel</span><span class="o">.</span><span class="n">get_bodies</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>   <span class="c1"># SelectedOnly = False; used to select all bodies in the model.</span>
<span class="n">roombodies</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bodies</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">iesve</span><span class="o">.</span><span class="n">VEBody_type</span><span class="o">.</span><span class="n">room</span><span class="p">]</span>  <span class="c1"># iesve.VEBody_type.room has an integer value of 1.</span>
</pre></div>
</div>
<ul class="simple">
<li><p><cite>currentproject</cite> is an instance of the <a class="reference internal" href="api.html#iesve.VEProject" title="iesve.VEProject"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEProject</span></code></a> class.</p></li>
<li><p><cite>realmodel</cite> is an instance of the <a class="reference internal" href="api.html#iesve.VEModel" title="iesve.VEModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEModel</span></code></a> class.</p></li>
<li><p><cite>bodies</cite> is a list of <a class="reference internal" href="api.html#iesve.VEBody" title="iesve.VEBody"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEBody</span></code></a> instances.</p></li>
<li><p><cite>roombodies</cite> is a list of <a class="reference internal" href="api.html#iesve.VEBody" title="iesve.VEBody"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEBody</span></code></a> instances.</p></li>
</ul>
</section>
<section id="how-to-access-the-path-of-the-current-project">
<span id="id6"></span><h2>How to access the path of the current project<a class="headerlink" href="#how-to-access-the-path-of-the-current-project" title="Link to this heading"></a></h2>
<p>This gets the directory where the current IES-VE project is stored on the local computer. This is done using the <a class="reference internal" href="api.html#iesve.VEProject.path" title="iesve.VEProject.path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">path</span></code></a> propoerty of the <a class="reference internal" href="api.html#iesve.VEProject" title="iesve.VEProject"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEProject</span></code></a> class. If no path exists, the built-in Python GUI package <a class="reference external" href="https://docs.python.org/3/library/tkinter.html">Tkinter</a> is used to display an error message box.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iesve</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">Tk</span><span class="p">,</span> <span class="n">messagebox</span>
<span class="n">currentproject</span> <span class="o">=</span> <span class="n">iesve</span><span class="o">.</span><span class="n">VEProject</span><span class="o">.</span><span class="n">get_current_project</span><span class="p">()</span>
<span class="n">dir_currentproject</span> <span class="o">=</span> <span class="n">currentproject</span><span class="o">.</span><span class="n">path</span>
<span class="k">if</span> <span class="n">dir_currentproject</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>  <span class="c1"># if no path exists, show an error message box then exit.</span>
   <span class="n">root</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
   <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
   <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s1">&#39;User action required&#39;</span><span class="p">,</span> <span class="s1">&#39;Please save the IES-VE project.&#39;</span><span class="p">,</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">root</span><span class="p">)</span>
   <span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
   <span class="n">quit</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p><cite>currentproject</cite> is an instance of the <a class="reference internal" href="api.html#iesve.VEProject" title="iesve.VEProject"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEProject</span></code></a> class.</p></li>
<li><p><cite>dir_currentproject</cite> is a string of the full path to the IES-VE project as saved on the local computer.</p></li>
</ul>
</section>
<section id="how-to-ask-the-user-to-choose-a-ies-ve-result-file">
<span id="how-to-ask-the-user-to-choose-a-ies-ve-results-file"></span><h2>How to ask the user to choose a IES-VE result file<a class="headerlink" href="#how-to-ask-the-user-to-choose-a-ies-ve-result-file" title="Link to this heading"></a></h2>
<p>This opens a dialog box for the user to select an IES-VE results file (an .aps file). The built-in Python GUI package <a class="reference external" href="https://docs.python.org/3/library/tkinter.html">Tkinter</a> is used to display an error message box if no file is selected or the file selected is not in the current IES-VE project.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iesve</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">Tk</span><span class="p">,</span> <span class="n">messagebox</span>
<span class="kn">from</span> <span class="nn">tkinter.filedialog</span> <span class="kn">import</span> <span class="n">askopenfilename</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">currentproject</span> <span class="o">=</span> <span class="n">iesve</span><span class="o">.</span><span class="n">VEProject</span><span class="o">.</span><span class="n">get_current_project</span><span class="p">()</span>
<span class="n">dir_currentproject</span> <span class="o">=</span> <span class="n">currentproject</span><span class="o">.</span><span class="n">path</span>
<span class="n">dir_vista</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_currentproject</span><span class="p">,</span> <span class="s1">&#39;vista&#39;</span><span class="p">)</span>
<span class="n">root</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
<span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
<span class="n">fp_in</span> <span class="o">=</span> <span class="n">askopenfilename</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Select IES results file&#39;</span><span class="p">,</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">root</span><span class="p">,</span> <span class="n">initialdir</span> <span class="o">=</span> <span class="n">dir_vista</span><span class="p">,</span> <span class="n">filetypes</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;APS files&quot;</span><span class="p">,</span><span class="s2">&quot;*.aps&quot;</span><span class="p">)])</span>
<span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
<span class="c1"># - Exit if filepath is empty string</span>
<span class="k">if</span> <span class="n">fp_in</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
   <span class="n">root</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
   <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
   <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s1">&#39;User input needed&#39;</span><span class="p">,</span> <span class="s1">&#39;Please select a .aps results file.&#39;</span><span class="p">,</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">root</span><span class="p">)</span>
   <span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
   <span class="n">quit</span><span class="p">()</span>
<span class="c1"># - Exit if filepath is not in project filepath</span>
<span class="k">elif</span> <span class="ow">not</span> <span class="n">dir_currentproject</span> <span class="ow">in</span> <span class="n">fp_in</span><span class="p">:</span>
   <span class="n">root</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
   <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
   <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s1">&#39;User input needed&#39;</span><span class="p">,</span> <span class="s1">&#39;Please select a .aps results file in the current IES project.&#39;</span><span class="p">,</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">root</span><span class="p">)</span>
   <span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
   <span class="n">quit</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p><cite>currentproject</cite> is an instance of the <a class="reference internal" href="api.html#iesve.VEProject" title="iesve.VEProject"><code class="xref py py-class docutils literal notranslate"><span class="pre">VEProject</span></code></a> class.</p></li>
<li><p><cite>dir_currentproject</cite> is a string of the full path to the IES-VE project as saved on the local computer.</p></li>
<li><p><cite>dir_vista</cite> is a string of the full path to the vista folder of the IES-VE project as saved on the local computer. This is where the .aps results files are stored.</p></li>
<li><p><cite>fp_in</cite> is a string of the full path to the IES-VE results file as chosen by the user.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quick_start.html" class="btn btn-neutral float-left" title="Quick Start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="examples.html" class="btn btn-neutral float-right" title="Example Scripts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Steven Firth.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>